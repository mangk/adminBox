import"./XvueBaz_cZdj.js";import{r as e,a as l,b as a,c as t,d as o}from"./XroleB9dttx_C.js";import i from"./XpremissionSetBTrV1eJR.js";import{b as r,$ as s,j as u,ah as d,o as n,c as p,X as m,Q as c,V as v,P as f,U as g,a as j,i as _}from"./X@vuen9TiMG2O.js";import"./XindexDonZ4tkV.js";import"./XpiniaYeQOi8UL.js";import"./Xelement-plusDOiKS2FB.js";import"./Xlodash-esBg5u8xPa.js";import"./X@vueuseCCX6pF6_.js";import"./X@element-plusrftQev1h.js";import"./X@popperjsD3lHDW-0.js";import"./X@ctrlD2oWfImC.js";import"./Xdayjst441MSVg.js";import"./Xasync-validatorCuo4gI4y.js";import"./Xmemoize-oneDs0C_khL.js";import"./Xnormalize-wheel-esVn5vHDCm.js";import"./X@floating-uipMauM7H8.js";import"./XaxiosDtE8dZ3W.js";import"./XmittCNZ6avp8.js";import"./Xvue-routerzsXVQF6n.js";import"./XnprogressDgs0sPf-.js";import"./Xvue3-sfc-loaderDa78GGQm.js";import"./X_plugin-vue_export-helperBCo6x5W8.js";const h={class:"main-content"},X={class:"dialog-footer"},y={__name:"role",setup(y){const b=r(0),{proxy:w}=_(),k=r([]),C=r(1),z=r(20),V=r(0),x=r(!1),U=r(),P=s({id:0,name:"",description:""}),$=s({name:[{required:!0,message:"角色名称 不能为空",trigger:"blur"}]}),D=()=>{e(C.value,z.value).then((e=>{k.value=e.data.list,C.value=e.data.page,z.value=e.data.page_size,V.value=e.data.total}))},I=e=>{z.value=e,D()},S=e=>{C.value=e,D()},F=(e=!1)=>{e?(P.id=e,l(e).then((e=>{0===e.code&&(P.id=e.data.id,P.name=e.data.name,P.description=e.data.description)}))):P.id=0,x.value=!0},q=e=>{x.value=!1,A(e)},A=e=>{e&&e.resetFields()};return u((()=>{D()})),(e,l)=>{const r=d("Plus"),s=d("el-icon"),u=d("el-button"),_=d("el-form-item"),y=d("el-table-column"),E=d("Edit"),G=d("Filter"),Q=d("Delete"),R=d("el-popconfirm"),B=d("el-table"),H=d("el-pagination"),J=d("el-input"),K=d("el-form"),L=d("el-dialog");return n(),p("div",h,[m(_,{label:""},{default:c((()=>[m(u,{type:"primary",onClick:l[0]||(l[0]=e=>F())},{default:c((()=>[m(s,null,{default:c((()=>[m(r)])),_:1}),v(" 新建角色 ")])),_:1})])),_:1}),m(B,{data:k.value,"row-key":"id",height:"var(--global-table)",border:"","highlight-current-row":"","show-overflow-tooltip":""},{default:c((()=>[m(y,{prop:"id",label:"ID",sortable:"",fixed:"",width:"80"}),m(y,{prop:"name",label:"角色名称",width:"260"}),m(y,{prop:"description",label:"角色描述"}),m(y,{fixed:"right",label:"操作",width:"200"},{default:c((e=>[m(u,{link:"",type:"primary",size:"small",onClick:l=>F(e.row.id)},{default:c((()=>[m(s,null,{default:c((()=>[m(E)])),_:1}),v(" 编辑 ")])),_:2},1032,["onClick"]),m(u,{link:"",type:"primary",size:"small",onClick:l=>b.value=e.row.id},{default:c((()=>[m(s,null,{default:c((()=>[m(G)])),_:1}),v(" 权限设置 ")])),_:2},1032,["onClick"]),e.row.children?g("",!0):(n(),f(R,{key:0,title:"删除后不可恢复，确定删除API【"+e.row.name+"】?",onConfirm:l=>{var t;(t=e.row.id)?a(t).then((e=>{0===e.code&&(w.$message.success(e.msg),D())})):w.$message.error("请选择数据ID")},width:"200"},{reference:c((()=>[m(u,{link:"",type:"primary",size:"small"},{default:c((()=>[m(s,null,{default:c((()=>[m(Q)])),_:1}),v(" 删除 ")])),_:1})])),_:2},1032,["title","onConfirm"]))])),_:1})])),_:1},8,["data"]),m(H,{"current-page":C.value,"onUpdate:currentPage":l[1]||(l[1]=e=>C.value=e),"page-size":z.value,"onUpdate:pageSize":l[2]||(l[2]=e=>z.value=e),"page-sizes":[20,50,100,200],size:"small",layout:"total, sizes, prev, pager, next, jumper",total:V.value,onSizeChange:I,onCurrentChange:S},null,8,["current-page","page-size","total"]),m(L,{modelValue:x.value,"onUpdate:modelValue":l[8]||(l[8]=e=>x.value=e),title:P.id?"编辑角色":"新建角色",width:"80vw","append-to-body":"",onClose:l[9]||(l[9]=e=>q(U.value))},{footer:c((()=>[j("div",X,[m(u,{onClick:l[5]||(l[5]=e=>A(U.value))},{default:c((()=>[v("重置")])),_:1}),m(u,{onClick:l[6]||(l[6]=e=>q(U.value))},{default:c((()=>[v("取消")])),_:1}),m(u,{type:"primary",onClick:l[7]||(l[7]=e=>(async e=>{e&&await e.validate(((l,a)=>{if(l){let l={};l=P.id?t(P):o(P),l.then((l=>{0===l.code&&(w.$message.success(l.msg),D(),x.value=!1,A(e))}))}}))})(U.value))},{default:c((()=>[v("保存")])),_:1})])])),default:c((()=>[m(K,{ref_key:"formRef",ref:U,model:P,rules:$,"status-icon":"","label-position":"top","show-all-levels":!1},{default:c((()=>[m(_,{label:"角色名称",prop:"name"},{default:c((()=>[m(J,{modelValue:P.name,"onUpdate:modelValue":l[3]||(l[3]=e=>P.name=e)},null,8,["modelValue"])])),_:1}),m(_,{label:"角色描述",prop:"description"},{default:c((()=>[m(J,{modelValue:P.description,"onUpdate:modelValue":l[4]||(l[4]=e=>P.description=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"]),m(i,{modelValue:b.value,"onUpdate:modelValue":l[10]||(l[10]=e=>b.value=e),type:"sys_role"},null,8,["modelValue"])])}}};export{y as default};
