import{N as R,r as U,a as W,B as E,O as H,P as J,f as m,o as a,j as f,w as t,e as V,d as e,g as d,t as B,c as u,F as x,z as $,k as v,Q as K}from"./Xindexa4Gb5-_L.js";import{_ as X}from"./X_plugin-vue_export-helperDlAUqK2U.js";const Y={class:"select-item-box with-out-border-top"},Z={class:"select-item-box with-out-border-top"},ee={class:"select-item-box with-out-border-top"},te={style:{display:"flex","flex-flow":"row nowrap","justify-content":"space-between"}},le={style:{"text-align":"left"}},ae={style:{color:"#f56c6c","font-size":"12px"}},oe={style:{color:"#e6a23c","font-size":"12px"}},se={__name:"premissionSet",props:{modelValue:{type:Number},modelModifiers:{},type:{type:String},typeModifiers:{}},emits:["update:modelValue","update:type"],setup(N){const j=R(N,"modelValue"),F=R(N,"type"),P=U(!1),A=U([]),_=W({}),O=U([]),y=W({});E(j,s=>{s&&(P.value=!0,H().then(i=>{A.value=i.data}),J(j.value,F.value).then(i=>{var h,o,g,z,p;O.value=(h=i.data)==null?void 0:h.ohter_set_list,Object.assign(_,(g=(o=i.data)==null?void 0:o.cur_set)==null?void 0:g.list),Object.assign(y,(p=(z=i.data)==null?void 0:z.result_set)==null?void 0:p.list)}))}),E(_,s=>{for(const i in s)Object.hasOwnProperty.call(s,i)&&(y[i]=G(i))});const G=s=>{var i=0,h=[],o=[];_[s]&&(i=_[s]);for(const w in O.value)if(Object.hasOwnProperty.call(O.value,w)){const c=O.value[w];c.module=="sys_role"&&c.list&&c.list[s]&&h.push(c.list[s]),c.module=="sys_department"&&c.list&&c.list[s]&&o.push(c.list[s])}var g=D(h),z=D(o),p=0;return z!==0&&(p=z),g!==0&&(p=g),i!==0&&(p=i),p},D=s=>{var i=0;for(let h=0;h<s.length;h++){const o=s[h];if(o==-1)return-1;o==1&&i++}return i>0?1:0},Q=()=>{K({id:j.value,module:F.value,list:_}).then(()=>{M()})},M=()=>{P.value=!1,j.value=0,O.value=[];for(const s in _)Object.hasOwnProperty.call(_,s)&&delete _[s];for(const s in y)Object.hasOwnProperty.call(y,s)&&delete y[s]};return(s,i)=>{const h=m("Menu"),o=m("el-icon"),g=m("Link"),z=m("Cherry"),p=m("el-table-column"),w=m("Check"),c=m("Close"),b=m("el-radio"),S=m("el-radio-group"),T=m("el-table"),I=m("el-button"),L=m("WarningFilled"),q=m("el-drawer");return a(),f(q,{modelValue:P.value,"onUpdate:modelValue":i[0]||(i[0]=l=>P.value=l),direction:"rtl","before-close":M,"with-header":!1,size:"90%"},{footer:t(()=>[V("div",te,[V("div",null,[e(I,{onClick:Q,type:"primary"},{default:t(()=>[d("保存")]),_:1}),e(I,{onClick:M},{default:t(()=>[d("关闭")]),_:1})]),V("div",le,[V("div",ae,[e(o,null,{default:t(()=>[e(L)]),_:1}),d(" 权限分级说明: 个人设置 > 角色设置 > 部门设置 ")]),V("div",oe,[e(o,null,{default:t(()=>[e(L)]),_:1}),d(" 权限同级说明: 拒绝 > 允许; ")])])])]),default:t(()=>[e(T,{"header-cell-class-name":"global-el-table-header",data:A.value,height:"calc(100vh - 62px - 40px )",style:{width:"100%"},"row-key":"id",border:"","default-expand-all":""},{default:t(()=>[e(p,{label:"菜单 · API · 动作",width:"190px",fixed:""},{default:t(l=>[e(o,null,{default:t(()=>[e(h)]),_:1}),d(" "+B(l.row.meta.title)+" ",1),(a(!0),u(x,null,$(l.row.meta.api_list,n=>(a(),u("div",{class:"select-item-box",key:n.id},[e(o,null,{default:t(()=>[e(g)]),_:1}),d(" "+B(n.name),1)]))),128)),(a(!0),u(x,null,$(l.row.meta.action_list,(n,r)=>(a(),u("div",{class:"select-item-box",key:r},[e(o,null,{default:t(()=>[e(z)]),_:1}),d(" "+B(n),1)]))),128))]),_:1}),e(p,{label:"结果展示",fixed:"",width:"70px"},{default:t(l=>[V("div",Y,[y[`menu|${l.row.id}`]>0?(a(),f(o,{key:0,style:{color:"#67c23a"}},{default:t(()=>[e(w)]),_:1})):v("",!0),y[`menu|${l.row.id}`]<0?(a(),f(o,{key:1,style:{color:"#f56c6c"}},{default:t(()=>[e(c)]),_:1})):v("",!0)]),(a(!0),u(x,null,$(l.row.meta.api_list,n=>(a(),u("div",{class:"select-item-box",key:n.id},[y[`api|${n.id}`]>0?(a(),f(o,{key:0,style:{color:"#67c23a"}},{default:t(()=>[e(w)]),_:1})):v("",!0),y[`api|${n.id}`]<0?(a(),f(o,{key:1,style:{color:"#f56c6c"}},{default:t(()=>[e(c)]),_:1})):v("",!0)]))),128)),(a(!0),u(x,null,$(l.row.meta.action_list,(n,r)=>(a(),u("div",{class:"select-item-box",key:r},[y[`action|${r}`]>0?(a(),f(o,{key:0,style:{color:"#67c23a"}},{default:t(()=>[e(w)]),_:1})):v("",!0),y[`action|${r}`]<0?(a(),f(o,{key:1,style:{color:"#f56c6c"}},{default:t(()=>[e(c)]),_:1})):v("",!0)]))),128))]),_:1}),e(p,{label:"当前设置",fixed:"",width:"220px"},{default:t(l=>[V("div",Z,[e(S,{modelValue:_[`menu|${l.row.id}`],"onUpdate:modelValue":n=>_[`menu|${l.row.id}`]=n},{default:t(()=>[e(b,{size:"small",value:1},{default:t(()=>[d("允许")]),_:1}),e(b,{size:"small",value:-1},{default:t(()=>[d("拒绝")]),_:1}),e(b,{size:"small",value:0},{default:t(()=>[d("不限")]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),(a(!0),u(x,null,$(l.row.meta.api_list,n=>(a(),u("div",{class:"select-item-box",key:n.id},[e(S,{modelValue:_[`api|${n.id}`],"onUpdate:modelValue":r=>_[`api|${n.id}`]=r},{default:t(()=>[e(b,{size:"small",value:1},{default:t(()=>[d("允许")]),_:1}),e(b,{size:"small",value:-1},{default:t(()=>[d("拒绝")]),_:1}),e(b,{size:"small",value:0},{default:t(()=>[d("不限")]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]))),128)),(a(!0),u(x,null,$(l.row.meta.action_list,(n,r)=>(a(),u("div",{class:"select-item-box",key:r},[e(S,{modelValue:_[`action|${r}`],"onUpdate:modelValue":k=>_[`action|${r}`]=k},{default:t(()=>[e(b,{size:"small",value:1},{default:t(()=>[d("允许")]),_:1}),e(b,{size:"small",value:-1},{default:t(()=>[d("拒绝")]),_:1}),e(b,{size:"small",value:0},{default:t(()=>[d("不限")]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]))),128))]),_:1}),(a(!0),u(x,null,$(O.value,(l,n)=>(a(),f(p,{key:n,label:l.record_name},{default:t(r=>[V("div",ee,[l.list&&l.list[`menu|${r.row.id}`]&&l.list[`menu|${r.row.id}`]>0?(a(),f(o,{key:0,style:{color:"#67c23a"}},{default:t(()=>[e(w)]),_:1})):v("",!0),l.list&&l.list[`menu|${r.row.id}`]&&l.list[`menu|${r.row.id}`]<0?(a(),f(o,{key:1,style:{color:"#f56c6c"}},{default:t(()=>[e(c)]),_:1})):v("",!0)]),(a(!0),u(x,null,$(r.row.meta.api_list,k=>(a(),u("div",{class:"select-item-box",key:k.id},[l.list&&l.list[`api|${k.id}`]&&l.list[`api|${k.id}`]>0?(a(),f(o,{key:0,style:{color:"#67c23a"}},{default:t(()=>[e(w)]),_:1})):v("",!0),l.list&&l.list[`api|${k.id}`]&&l.list[`api|${k.id}`]<0?(a(),f(o,{key:1,style:{color:"#f56c6c"}},{default:t(()=>[e(c)]),_:1})):v("",!0)]))),128)),(a(!0),u(x,null,$(r.row.meta.action_list,(k,C)=>(a(),u("div",{class:"select-item-box",key:C},[l.list&&l.list[`action|${C}`]&&l.list[`action|${C}`]>0?(a(),f(o,{key:0,style:{color:"#67c23a"}},{default:t(()=>[e(w)]),_:1})):v("",!0),l.list&&l.list[`action|${C}`]&&l.list[`action|${C}`]<0?(a(),f(o,{key:1,style:{color:"#f56c6c"}},{default:t(()=>[e(c)]),_:1})):v("",!0)]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["data"])]),_:1},8,["modelValue"])}}},re=X(se,[["__scopeId","data-v-222dc94d"]]);export{re as default};
