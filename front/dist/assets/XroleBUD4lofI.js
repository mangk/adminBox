import"./XvueVe3_Elhr.js";import{r as e,a as l,b as a,c as t,d as o}from"./XroleaR_Ltp1q.js";import i from"./XpremissionSetmYIRXBHX.js";import{e as s,k as r,m as u,al as d,o as n,c as p,Q as m,I as c,M as v,H as f,L as g,a as j,l as _}from"./X@vueCM7II4So.js";import"./XindexB3gMGtar.js";import"./XpiniaHbUHA5wR.js";import"./Xelement-plusCO1bik-q.js";import"./Xlodash-esBCrAzI1e.js";import"./X@vueuseDU8TvUvn.js";import"./X@element-plusCerOoRDG.js";import"./X@popperjsD3lHDW-0.js";import"./X@ctrlD2oWfImC.js";import"./XdayjsBLCVIqfw.js";import"./Xcos-js-sdk-v5B2H1ItxU.js";import"./Xasync-validatorCuo4gI4y.js";import"./Xmemoize-oneDs0C_khL.js";import"./Xnormalize-wheel-esVn5vHDCm.js";import"./X@floating-uipMauM7H8.js";import"./XaxiosDtE8dZ3W.js";import"./XmittCNZ6avp8.js";import"./Xvue-routerCYJBVSJE.js";import"./XnprogressCIdgZ774.js";import"./Xvue3-sfc-loaderDa78GGQm.js";import"./X_plugin-vue_export-helperBCo6x5W8.js";const X={class:"main-content"},h={class:"dialog-footer"},y={__name:"role",setup(y){const b=s(0),{proxy:w}=_(),k=s([]),C=s(1),z=s(20),V=s(0),x=s(!1),U=s(),I=r({id:0,name:"",description:""}),D=r({name:[{required:!0,message:"角色名称 不能为空",trigger:"blur"}]}),P=()=>{e(C.value,z.value).then((e=>{k.value=e.data.list,C.value=e.data.page,z.value=e.data.page_size,V.value=e.data.total}))},S=e=>{z.value=e,P()},$=e=>{C.value=e,P()},F=(e=!1)=>{e?(I.id=e,l(e).then((e=>{0===e.code&&(I.id=e.data.id,I.name=e.data.name,I.description=e.data.description)}))):I.id=0,x.value=!0},M=e=>{x.value=!1,q(e)},q=e=>{e&&e.resetFields()};return u((()=>{P()})),(e,l)=>{const s=d("Plus"),r=d("el-icon"),u=d("el-button"),_=d("el-form-item"),y=d("el-table-column"),A=d("Edit"),E=d("Filter"),H=d("Delete"),L=d("el-popconfirm"),Q=d("el-table"),R=d("el-pagination"),B=d("el-input"),G=d("el-form"),J=d("el-dialog");return n(),p("div",X,[m(_,{label:""},{default:c((()=>[m(u,{type:"primary",onClick:l[0]||(l[0]=e=>F())},{default:c((()=>[m(r,null,{default:c((()=>[m(s)])),_:1}),v(" 新建角色 ")])),_:1})])),_:1}),m(Q,{data:k.value,"row-key":"id",height:"var(--global-table)",border:"","highlight-current-row":"","show-overflow-tooltip":""},{default:c((()=>[m(y,{prop:"id",label:"ID",sortable:"",fixed:"",width:"80"}),m(y,{prop:"name",label:"角色名称",width:"260"}),m(y,{prop:"description",label:"角色描述"}),m(y,{fixed:"right",label:"操作",width:"200"},{default:c((e=>[m(u,{link:"",type:"primary",size:"small",onClick:l=>F(e.row.id)},{default:c((()=>[m(r,null,{default:c((()=>[m(A)])),_:1}),v(" 编辑 ")])),_:2},1032,["onClick"]),m(u,{link:"",type:"primary",size:"small",onClick:l=>b.value=e.row.id},{default:c((()=>[m(r,null,{default:c((()=>[m(E)])),_:1}),v(" 权限设置 ")])),_:2},1032,["onClick"]),e.row.children?g("",!0):(n(),f(L,{key:0,title:"删除后不可恢复，确定删除API【"+e.row.name+"】?",onConfirm:l=>{var t;(t=e.row.id)?a(t).then((e=>{0===e.code&&(w.$message.success(e.msg),P())})):w.$message.error("请选择数据ID")},width:"200"},{reference:c((()=>[m(u,{link:"",type:"primary",size:"small"},{default:c((()=>[m(r,null,{default:c((()=>[m(H)])),_:1}),v(" 删除 ")])),_:1})])),_:2},1032,["title","onConfirm"]))])),_:1})])),_:1},8,["data"]),m(R,{"current-page":C.value,"onUpdate:currentPage":l[1]||(l[1]=e=>C.value=e),"page-size":z.value,"onUpdate:pageSize":l[2]||(l[2]=e=>z.value=e),"page-sizes":[20,50,100,200],size:"small",layout:"total, sizes, prev, pager, next, jumper",total:V.value,onSizeChange:S,onCurrentChange:$},null,8,["current-page","page-size","total"]),m(J,{modelValue:x.value,"onUpdate:modelValue":l[8]||(l[8]=e=>x.value=e),title:I.id?"编辑角色":"新建角色",width:"80vw","append-to-body":"",onClose:l[9]||(l[9]=e=>M(U.value))},{footer:c((()=>[j("div",h,[m(u,{onClick:l[5]||(l[5]=e=>q(U.value))},{default:c((()=>[v("重置")])),_:1}),m(u,{onClick:l[6]||(l[6]=e=>M(U.value))},{default:c((()=>[v("取消")])),_:1}),m(u,{type:"primary",onClick:l[7]||(l[7]=e=>(async e=>{e&&await e.validate(((l,a)=>{if(l){let l={};l=I.id?t(I):o(I),l.then((l=>{0===l.code&&(w.$message.success(l.msg),P(),x.value=!1,q(e))}))}}))})(U.value))},{default:c((()=>[v("保存")])),_:1})])])),default:c((()=>[m(G,{ref_key:"formRef",ref:U,model:I,rules:D,"status-icon":"","label-position":"top","show-all-levels":!1},{default:c((()=>[m(_,{label:"角色名称",prop:"name"},{default:c((()=>[m(B,{modelValue:I.name,"onUpdate:modelValue":l[3]||(l[3]=e=>I.name=e)},null,8,["modelValue"])])),_:1}),m(_,{label:"角色描述",prop:"description"},{default:c((()=>[m(B,{modelValue:I.description,"onUpdate:modelValue":l[4]||(l[4]=e=>I.description=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"]),m(i,{modelValue:b.value,"onUpdate:modelValue":l[10]||(l[10]=e=>b.value=e),type:"sys_role"},null,8,["modelValue"])])}}};export{y as default};
