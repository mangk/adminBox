import"./XvueBaz_cZdj.js";import{h as e,u as l,s as a}from"./XindexC9xXd3Oz.js";import{E as t}from"./Xelement-plusCLM398fa.js";import{bH as i,b as o,ah as u,o as s,c as r,a as d,J as n,X as p,Q as v,V as f,F as m,a8 as g,P as c,U as h,u as y,K as x,W as j}from"./X@vuen9TiMG2O.js";import"./XpiniaYeQOi8UL.js";import"./X@element-plusBnJF7_W-.js";import"./XaxiosByKc3Ecy.js";import"./XmittCNZ6avp8.js";import"./Xvue-routerzsXVQF6n.js";import"./XnprogressDgs0sPf-.js";import"./Xdayjst441MSVg.js";import"./Xvue3-sfc-loaderDa78GGQm.js";import"./Xlodash-esBg5u8xPa.js";import"./X@vueuseCCX6pF6_.js";import"./X@popperjsD3lHDW-0.js";import"./X@ctrlD2oWfImC.js";import"./Xasync-validatorCuo4gI4y.js";import"./Xmemoize-oneDs0C_khL.js";import"./Xnormalize-wheel-esVn5vHDCm.js";import"./X@floating-uipMauM7H8.js";const X={style:{display:"flex","flex-flow":"row wrap",padding:"var(--global-padding)"}},z=["onMouseleave","onMouseover","onClick"],b={style:{"font-size":"30px","text-align":"center",margin:"var(--global-padding)","margin-bottom":"0"}},w={style:{"font-size":"12px","line-height":"12px",padding:"3px","text-align":"center"}},_={style:{"font-size":"12px","line-height":"12px",padding:"3px",position:"absolute",left:"0",top:"0","background-color":"#409eff",color:"#fff","border-radius":"0 0 5px 0"}},k={key:0},U={class:"el-upload__text",style:{height:"40px","line-height":"40px","text-align":"center",overflow:"hidden",display:"flex","flex-flow":"row nowrap","justify-content":"center"}},C=d("em",null,"点击上传",-1),V={__name:"fileUpload",props:{modelValue:{},modelModifiers:{},multiple:{default:1,type:Number},multipleModifiers:{},onlyPath:{default:!1,type:Boolean},onlyPathModifiers:{},suffixList:{default:[],type:Array},suffixListModifiers:{}},emits:["update:modelValue","update:multiple","update:onlyPath","update:suffixList"],setup(V){const M=l(),P=i(V,"modelValue"),E=i(V,"multiple"),L=i(V,"onlyPath"),O=i(V,"suffixList"),$=o([]),S=o({}),T=o("default"),A=o(!1),B=o([]),D=o(1),F=o(25),q=o(0),G=()=>{((l=1,a=20,t={})=>e({url:"/sys/fileUpload/page",method:"POST",data:{page:l,page_size:a,query:t}}))(D.value,F.value,{tag:O.value}).then((e=>{B.value=e.data.list,D.value=e.data.page,F.value=e.data.page_size,q.value=e.data.total}))},H=e=>{for(const l in $.value)if(Object.hasOwnProperty.call($.value,l)){if($.value[l].id==e)return"img-item-select"}},J=(e,l,a)=>{G()},K=o(0),N=l=>{(l=>e({url:"/sys/fileUpload",method:"DELETE",data:{id:l}}))(l).then((e=>{for(let a=0;a<$.value.length;a++){$.value[a].id==l&&($.value.splice(a,1),P.value=$.value)}G()}))},Q=e=>{F.value=e,G()},W=e=>{D.value=e,G()},I=()=>{e({url:"/sys/fileUpload/cfg",method:"GET"}).then((e=>{S.value=e.data})),G(),A.value=!0},R=()=>{Y(),A.value=!1},Y=()=>{if($.value.length&&L.value)if(1==E.value)P.value=$.value[0].url;else{let e=[];for(let l=0;l<$.value.length;l++){const a=$.value[l];e.push(a.url)}P.value=e}};return(e,l)=>{const i=u("UploadFilled"),o=u("el-icon"),V=u("el-button"),L=u("el-pagination"),O=u("CircleClose"),G=u("Document"),Z=u("el-image"),ee=u("el-radio-button"),le=u("el-radio-group"),ae=u("upload-filled"),te=u("el-upload"),ie=u("el-drawer");return s(),r(m,null,[d("div",{class:"upload-file-slot",onClick:I},[n(e.$slots,"default",{},(()=>[p(V,{type:"primary"},{default:v((()=>[p(o,null,{default:v((()=>[p(i)])),_:1}),f(" 文件上传 ")])),_:1})]))]),p(ie,{modelValue:A.value,"onUpdate:modelValue":l[3]||(l[3]=e=>A.value=e),direction:"rtl","before-close":R,"show-close":!1,size:"50%;",style:{"max-width":"600px"}},{header:v((()=>[p(L,{"current-page":D.value,"onUpdate:currentPage":l[0]||(l[0]=e=>D.value=e),"page-size":F.value,"onUpdate:pageSize":l[1]||(l[1]=e=>F.value=e),"page-sizes":[20,50,100,200],size:"small",layout:"total, prev, pager, next",total:q.value,onSizeChange:Q,onCurrentChange:W},null,8,["current-page","page-size","total"])])),footer:v((()=>[Object.keys(S.value).length>1?(s(),r("div",k,[p(le,{modelValue:T.value,"onUpdate:modelValue":l[2]||(l[2]=e=>T.value=e),size:"small"},{default:v((()=>[(s(!0),r(m,null,g(S.value,((e,l)=>(s(),c(ee,{label:e.name,value:e.driver,key:e.driver},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])):h("",!0),p(te,{drag:"",action:`${y(a)()}/sys/fileUpload/upload?driver=${T.value}`,headers:{Authorization:"Bearer "+y(M).token()},"show-file-list":!1,multiple:"","on-success":J},{default:v((()=>[d("div",U,[p(o,{class:"el-icon--upload",style:{"font-size":"35px",margin:"0 var(--global-padding) 0 0"}},{default:v((()=>[p(ae)])),_:1}),f(" 将文件拖到此处或"),C])])),_:1},8,["action","headers"])])),default:v((()=>[d("div",X,[(s(!0),r(m,null,g(B.value,((e,l)=>(s(),r("div",{class:x(["img-item",H(e.id)]),onMouseleave:l=>(e.id,void(K.value=0)),onMouseover:l=>{return a=e.id,void(K.value=a);var a},onClick:l=>(e=>{if(1==E.value)return $.value.length&&$.value[0].id==e.id?$.value=[]:$.value=[e],P.value=$.value,void Y();for(let l=0;l<$.value.length;l++)if($.value[l].id==e.id)return $.value.splice(l,1),P.value=$.value,void Y();$.value.length>=E.value?t({type:"warning",message:`最多选择 ${E.value} 个`}):($.value.push(e),P.value=$.value,Y())})(e)},[K.value==e.id?(s(),c(o,{key:0,class:"img-del",onClick:l=>N(e.id)},{default:v((()=>[p(O)])),_:2},1032,["onClick"])):h("",!0),p(Z,{style:{width:"100%"},src:e.url,fit:"scale-down",lazy:""},{error:v((()=>[d("div",b,[p(o,{style:{"font-size":"28px"}},{default:v((()=>[p(G)])),_:1})]),d("div",w,j(e.name.split(".")[0]),1),d("div",_,j(e.name.split(".")[1]),1)])),_:2},1032,["src"])],42,z)))),256))])])),_:1},8,["modelValue"])],64)}}};export{V as default};
