import"./XvueVe3_Elhr.js";import{p as e,b as l,c as t}from"./XindexB3gMGtar.js";import{_ as a}from"./X_plugin-vue_export-helperBCo6x5W8.js";import{bG as o,e as s,k as i,f as r,al as d,o as u,H as n,I as p,a as m,Q as c,M as f,L as v,O as y,c as j,P as _,a4 as w}from"./X@vueCM7II4So.js";import"./XpiniaHbUHA5wR.js";import"./Xelement-plusCO1bik-q.js";import"./Xlodash-esBCrAzI1e.js";import"./X@vueuseDU8TvUvn.js";import"./X@element-plusCerOoRDG.js";import"./X@popperjsD3lHDW-0.js";import"./X@ctrlD2oWfImC.js";import"./XdayjsBLCVIqfw.js";import"./Xcos-js-sdk-v5B2H1ItxU.js";import"./Xasync-validatorCuo4gI4y.js";import"./Xmemoize-oneDs0C_khL.js";import"./Xnormalize-wheel-esVn5vHDCm.js";import"./X@floating-uipMauM7H8.js";import"./XaxiosDtE8dZ3W.js";import"./XmittCNZ6avp8.js";import"./Xvue-routerCYJBVSJE.js";import"./XnprogressCIdgZ774.js";import"./Xvue3-sfc-loaderDa78GGQm.js";const h={style:{display:"flex","flex-flow":"row nowrap","justify-content":"space-between"}},b={style:{"text-align":"left"}},X={style:{color:"#f56c6c","font-size":"12px"}},x={style:{color:"#e6a23c","font-size":"12px"}},k=a({__name:"premissionSet",props:{modelValue:{type:Number},modelModifiers:{},type:{type:String},typeModifiers:{}},emits:["update:modelValue","update:type"],setup(a){const k=o(a,"modelValue"),g=o(a,"type"),O=s(!1),V=s([]),z=i({}),P=s([]),C=i({});r(k,(t=>{t&&(O.value=!0,e().then((e=>{V.value=e.data})),l(k.value,g.value).then((e=>{var l,t,a,o,s;P.value=null==(l=e.data)?void 0:l.ohter_set_list,Object.assign(z,null==(a=null==(t=e.data)?void 0:t.cur_set)?void 0:a.list),Object.assign(C,null==(s=null==(o=e.data)?void 0:o.result_set)?void 0:s.list)})))})),r(z,(e=>{for(const l in e)Object.hasOwnProperty.call(e,l)&&(C[l]=I(l))}));const I=e=>{var l=0,t=[],a=[];z[e]&&(l=z[e]);for(const r in P.value)if(Object.hasOwnProperty.call(P.value,r)){const l=P.value[r];"sys_role"==l.module&&l.list&&l.list[e]&&t.push(l.list[e]),"sys_department"==l.module&&l.list&&l.list[e]&&a.push(l.list[e])}var o=M(t),s=M(a),i=0;return 0!==s&&(i=s),0!==o&&(i=o),0!==l&&(i=l),i},M=e=>{var l=0;for(let t=0;t<e.length;t++){const a=e[t];if(-1==a)return-1;1==a&&l++}return l>0?1:0},U=()=>{t({id:k.value,module:g.value,list:z}).then((()=>{L()}))},L=()=>{O.value=!1,k.value=0,P.value=[];for(const e in z)Object.hasOwnProperty.call(z,e)&&delete z[e];for(const e in C)Object.hasOwnProperty.call(C,e)&&delete C[e]};return(e,l)=>{const t=d("Menu"),a=d("Link"),o=d("Pointer"),s=d("el-icon"),i=d("el-table-column"),r=d("Check"),k=d("Close"),g=d("el-radio"),I=d("el-radio-group"),M=d("el-table"),S=d("el-button"),A=d("WarningFilled"),F=d("el-drawer");return u(),n(F,{modelValue:O.value,"onUpdate:modelValue":l[0]||(l[0]=e=>O.value=e),direction:"rtl","before-close":L,"with-header":!1,"append-to-body":!0,size:"90%"},{footer:p((()=>[m("div",h,[m("div",null,[c(S,{onClick:U,type:"primary"},{default:p((()=>[f("保存")])),_:1}),c(S,{onClick:L},{default:p((()=>[f("关闭")])),_:1})]),m("div",b,[m("div",X,[c(s,null,{default:p((()=>[c(A)])),_:1}),f(" 权限分级说明: 个人设置 > 角色设置 > 部门设置 ")]),m("div",x,[c(s,null,{default:p((()=>[c(A)])),_:1}),f(" 权限同级说明: 拒绝 > 允许; ")])])])])),default:p((()=>[c(M,{data:V.value,height:"calc(100vh - 62px - 40px )",style:{width:"100%"},"row-key":"id",border:"","default-expand-all":""},{default:p((()=>[c(i,{label:"菜单 · API · 动作",width:"320px",fixed:""},{default:p((e=>[c(s,null,{default:p((()=>["menu"==e.row.type?(u(),n(t,{key:0})):v("",!0),"api"==e.row.type?(u(),n(a,{key:1})):v("",!0),"action"==e.row.type?(u(),n(o,{key:2})):v("",!0)])),_:2},1024),f(" "+y(e.row.name),1)])),_:1}),c(i,{label:"结果展示",fixed:"",width:"80px"},{default:p((e=>[C[e.row.id]>0?(u(),n(s,{key:0,style:{color:"#67c23a"}},{default:p((()=>[c(r)])),_:1})):v("",!0),C[e.row.id]<0?(u(),n(s,{key:1,style:{color:"#f56c6c"}},{default:p((()=>[c(k)])),_:1})):v("",!0)])),_:1}),c(i,{label:"当前设置",fixed:"",width:"220px"},{default:p((e=>[c(I,{modelValue:z[e.row.id],"onUpdate:modelValue":l=>z[e.row.id]=l},{default:p((()=>[c(g,{size:"small",value:1},{default:p((()=>[f("允许")])),_:1}),c(g,{size:"small",value:-1},{default:p((()=>[f("拒绝")])),_:1}),c(g,{size:"small",value:0},{default:p((()=>[f("不限")])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(u(!0),j(_,null,w(P.value,((e,l)=>(u(),n(i,{width:"220px",key:l,label:e.record_name},{default:p((l=>[e.list&&e.list[l.row.id]&&e.list[l.row.id]>0?(u(),n(s,{key:0,style:{color:"#67c23a"}},{default:p((()=>[c(r)])),_:1})):v("",!0),e.list&&e.list[l.row.id]&&e.list[l.row.id]<0?(u(),n(s,{key:1,style:{color:"#f56c6c"}},{default:p((()=>[c(k)])),_:1})):v("",!0)])),_:2},1032,["label"])))),128))])),_:1},8,["data"])])),_:1},8,["modelValue"])}}},[["__scopeId","data-v-152f25f3"]]);export{k as default};
