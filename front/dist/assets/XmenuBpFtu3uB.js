import"./XvueVe3_Elhr.js";import{a as e,b as l,c as a,d as t,m as o}from"./Xmenu8_wjIVhE.js";import{Q as d}from"./X@element-plusCerOoRDG.js";import{_ as i}from"./X_plugin-vue_export-helperBCo6x5W8.js";import{e as r,k as u,m as s,al as m,o as n,c as p,Q as c,I as f,M as h,a as _,O as b,H as v,K as g,L as y,P as w,a4 as V,D as k,l as j}from"./X@vueCM7II4So.js";import"./XindexB3gMGtar.js";import"./XpiniaHbUHA5wR.js";import"./Xelement-plusCO1bik-q.js";import"./Xlodash-esBCrAzI1e.js";import"./X@vueuseDU8TvUvn.js";import"./X@popperjsD3lHDW-0.js";import"./X@ctrlD2oWfImC.js";import"./XdayjsBLCVIqfw.js";import"./Xcos-js-sdk-v5B2H1ItxU.js";import"./Xasync-validatorCuo4gI4y.js";import"./Xmemoize-oneDs0C_khL.js";import"./Xnormalize-wheel-esVn5vHDCm.js";import"./X@floating-uipMauM7H8.js";import"./XaxiosDtE8dZ3W.js";import"./XmittCNZ6avp8.js";import"./Xvue-routerCYJBVSJE.js";import"./XnprogressCIdgZ774.js";import"./Xvue3-sfc-loaderDa78GGQm.js";const X={class:"main-content"},x={key:0,class:"icon-column"},U={key:0,style:{position:"absolute","z-index":"9999",padding:"4px 10px 0"}},C={style:{"text-align":"left",margin:"0 0 0 10px"}},q={class:"dialog-footer"},z=i({__name:"menu",setup(i){const{proxy:z}=j(),I=r(!1),D=r([]);r("");const E=u([]);for(const[e]of Object.entries(d))E.push({key:e,label:e});const K=r(),P=u({id:0,pid:"",name:"",path:"",hidden:!1,component:"",sort:0,meta:{title:"",keep_alive:!1,default_menu:!1,icon:"",auto_close:!1,sc_path:"",action_list:null}}),$=u({pid:[{required:!0,trigger:"blur",validator:(e,l,a)=>{""!==l?l!==P.id?a():a(new Error("所选菜单不能为当前编辑菜单")):a(new Error("父级菜单 不能为空"))}}],name:[{required:!0,message:"路由名称 不能为空",trigger:"blur"}],path:[{required:!0,message:"路由地址 不能为空",trigger:"blur"}],hidden:[{required:!0,message:"请选择 是否隐藏",trigger:"blur"}],"meta.title":[{required:!0,message:"菜单名称 不能为空",trigger:"blur"}],"meta.keep_alive":[{required:!0,message:"请选择 是否KeepAlive",trigger:"blur"}],"meta.default_menu":[{required:!0,message:"请选择 是否为基础页面",trigger:"blur"}],"meta.auto_close":[{required:!0,message:"请选择 是否自动关闭标签",trigger:"blur"}]}),A=e=>{I.value=!1,M(e)},M=e=>{e&&e.resetFields()},O=(e=!1)=>{e?(P.id=e,a(e).then((e=>{0===e.code&&(P.pid=e.data.pid,P.meta.title=e.data.meta.title,P.name=e.data.name,P.path=e.data.path,P.hidden=e.data.hidden,P.component=e.data.component,P.sort=e.data.sort,P.meta=e.data.meta)}))):P.id=0,H(),I.value=!0},Q=()=>{o().then((e=>{D.value=e.data[0].children,F.value=e.data}))},F=r([]),H=()=>{L(F.value,!1)},L=(e,l)=>{e&&e.forEach((e=>{e.children&&e.children.length?(e.title=e.meta.title,e.disabled=(l||e.id===P.id)&&P.id,L(e.children,e.disabled)):(e.title=e.meta.title,e.disabled=(l||e.id===P.id)&&P.id)}))};return s((()=>{Q()})),(a,o)=>{const d=m("Plus"),i=m("el-icon"),r=m("el-button"),u=m("el-form-item"),s=m("el-table-column"),j=m("el-tag"),H=m("Edit"),L=m("Cherry"),R=m("Delete"),S=m("el-popconfirm"),T=m("el-table"),B=m("el-cascader"),G=m("el-input"),J=m("el-option"),N=m("el-select"),W=m("el-form"),Y=m("el-dialog");return n(),p("div",X,[c(u,{label:""},{default:f((()=>[c(r,{type:"primary",onClick:o[0]||(o[0]=e=>O())},{default:f((()=>[c(i,null,{default:f((()=>[c(d)])),_:1}),h(" 新建目录 ")])),_:1})])),_:1}),c(T,{data:D.value,"row-key":"id",height:"var(--global-table)",border:"","highlight-current-row":"","show-overflow-tooltip":"","default-expand-all":""},{default:f((()=>[c(s,{prop:"id",label:"ID",sortable:"",fixed:""}),c(s,{label:"菜单名称","min-width":"120"},{default:f((e=>[_("span",null,b(e.row.meta.title),1)])),_:1}),c(s,{label:"图标","min-width":"140"},{default:f((e=>[e.row.meta.icon?(n(),p("div",x,[c(i,null,{default:f((()=>[(n(),v(g(e.row.meta.icon)))])),_:2},1024),_("span",null,b(e.row.meta.icon),1)])):y("",!0)])),_:1}),c(s,{prop:"name",label:"路由名称",width:"120"}),c(s,{prop:"path",label:"路由地址",width:"120"}),c(s,{prop:"hidden",label:"显示"},{default:f((e=>[e.row.hidden?y("",!0):(n(),v(j,{key:0,type:"success"},{default:f((()=>[h("显示")])),_:1})),e.row.hidden?(n(),v(j,{key:1,type:"error"},{default:f((()=>[h("隐藏")])),_:1})):y("",!0)])),_:1}),c(s,{prop:"pid",label:"父节点"}),c(s,{prop:"sort",label:"排序",width:"120",sortable:""}),c(s,{prop:"component",label:"模版路经",width:"260"}),c(s,{label:"服务端模版",width:"260"},{default:f((e=>[h(b(e.row.meta?e.row.meta.sc_path:""),1)])),_:1}),c(s,{prop:"action_list",label:"动作列表",width:"260"}),c(s,{fixed:"right",label:"操作",width:"210"},{default:f((e=>[c(r,{link:"",type:"primary",size:"small",onClick:l=>O(e.row.id)},{default:f((()=>[c(i,null,{default:f((()=>[c(H)])),_:1}),h(" 编辑 ")])),_:2},1032,["onClick"]),c(r,{link:"",type:"primary",size:"small"},{default:f((()=>[c(i,null,{default:f((()=>[c(L)])),_:1}),h(" 编辑动作 ")])),_:1}),e.row.children?y("",!0):(n(),v(S,{key:0,title:"删除后不可恢复，确定删除菜单【"+e.row.meta.title+"】?",onConfirm:l=>{var a;(a=e.row.id)?t(a).then((e=>{0===e.code&&(z.$message.success(e.msg),Q())})):z.$message.error("请选择数据ID")},width:"200"},{reference:f((()=>[c(r,{link:"",type:"primary",size:"small"},{default:f((()=>[c(i,null,{default:f((()=>[c(R)])),_:1}),h(" 删除 ")])),_:1})])),_:2},1032,["title","onConfirm"]))])),_:1})])),_:1},8,["data"]),c(Y,{modelValue:I.value,"onUpdate:modelValue":o[16]||(o[16]=e=>I.value=e),title:P.id?"编辑菜单":"新建菜单",width:"80vw","append-to-body":"",onClose:o[17]||(o[17]=e=>A(K.value))},{footer:f((()=>[_("div",q,[c(r,{onClick:o[13]||(o[13]=e=>M(K.value))},{default:f((()=>[h("重置")])),_:1}),c(r,{onClick:o[14]||(o[14]=e=>A(K.value))},{default:f((()=>[h("取消")])),_:1}),c(r,{type:"primary",onClick:o[15]||(o[15]=a=>(async a=>{a&&await a.validate(((t,o)=>{if(t){let t={};t=P.id?e(P):l(P),t.then((e=>{0===e.code&&(z.$message.success(e.msg),Q(),I.value=!1,M(a))}))}}))})(K.value))},{default:f((()=>[h("保存")])),_:1})])])),default:f((()=>[c(W,{ref_key:"formRef",ref:K,model:P,rules:$,"status-icon":"","label-position":"top","show-all-levels":!1,inline:""},{default:f((()=>[c(u,{label:"父级菜单",prop:"pid",style:{width:"40%"}},{default:f((()=>[c(B,{modelValue:P.pid,"onUpdate:modelValue":o[1]||(o[1]=e=>P.pid=e),options:F.value,props:{expandTrigger:"hover",checkStrictly:!0,value:"id",label:"title",emitPath:!1},style:{width:"100%"}},null,8,["modelValue","options"])])),_:1}),c(u,{label:"菜单名称",prop:"meta.title",style:{width:"40%"}},{default:f((()=>[c(G,{modelValue:P.meta.title,"onUpdate:modelValue":o[2]||(o[2]=e=>P.meta.title=e)},null,8,["modelValue"])])),_:1}),c(u,{label:"路由名称(name)",prop:"name",style:{width:"40%"}},{default:f((()=>[c(G,{modelValue:P.name,"onUpdate:modelValue":o[3]||(o[3]=e=>P.name=e)},null,8,["modelValue"])])),_:1}),c(u,{label:"路由地址(path)",prop:"path",style:{width:"40%"}},{default:f((()=>[c(G,{modelValue:P.path,"onUpdate:modelValue":o[4]||(o[4]=e=>P.path=e)},null,8,["modelValue"])])),_:1}),c(u,{label:"图标",prop:"meta.icon",style:{width:"40%"}},{default:f((()=>[P.meta.icon?(n(),p("span",U,[c(i,null,{default:f((()=>[(n(),v(g(P.meta.icon)))])),_:1})])):y("",!0),c(N,{modelValue:P.meta.icon,"onUpdate:modelValue":o[5]||(o[5]=e=>P.meta.icon=e),clearable:"",class:"icon-select"},{default:f((()=>[(n(!0),p(w,null,V(E,(e=>(n(),v(J,{key:e.key,label:e.key,value:e.label},{default:f((()=>[_("span",{class:k(["gva-icon",e.label]),style:{padding:"3px 0 0"}},[c(i,null,{default:f((()=>[(n(),v(g(e.label)))])),_:2},1024)],2),_("span",C,b(e.key),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),c(u,{label:"排序",prop:"sort",style:{width:"40%"}},{default:f((()=>[c(G,{type:"number",modelValue:P.sort,"onUpdate:modelValue":o[6]||(o[6]=e=>P.sort=e),modelModifiers:{number:!0}},null,8,["modelValue"])])),_:1}),c(u,{label:"模版地址",prop:"meta.component",style:{width:"40%"}},{default:f((()=>[c(G,{modelValue:P.component,"onUpdate:modelValue":o[7]||(o[7]=e=>P.component=e),placeholder:"views/util/serverComponent.vue"},null,8,["modelValue"])])),_:1}),c(u,{label:"服务端模版地址",prop:"meta.sc_path",style:{width:"40%"}},{default:f((()=>[c(G,{modelValue:P.meta.sc_path,"onUpdate:modelValue":o[8]||(o[8]=e=>P.meta.sc_path=e)},null,8,["modelValue"])])),_:1}),c(u,{label:"是否隐藏",prop:"hidden",style:{width:"40%"}},{default:f((()=>[c(N,{modelValue:P.hidden,"onUpdate:modelValue":o[9]||(o[9]=e=>P.hidden=e)},{default:f((()=>[c(J,{label:"否",value:!1}),c(J,{label:"是",value:!0})])),_:1},8,["modelValue"])])),_:1}),c(u,{label:"KeepAlive",prop:"meta.keep_alive",style:{width:"40%"}},{default:f((()=>[c(N,{modelValue:P.meta.keep_alive,"onUpdate:modelValue":o[10]||(o[10]=e=>P.meta.keep_alive=e)},{default:f((()=>[c(J,{label:"否",value:!1}),c(J,{label:"是",value:!0})])),_:1},8,["modelValue"])])),_:1}),c(u,{label:"基础页面",prop:"meta.default_menu",style:{width:"40%"}},{default:f((()=>[c(N,{modelValue:P.meta.default_menu,"onUpdate:modelValue":o[11]||(o[11]=e=>P.meta.default_menu=e)},{default:f((()=>[c(J,{label:"否",value:!1}),c(J,{label:"是",value:!0})])),_:1},8,["modelValue"])])),_:1}),c(u,{label:"自动关闭标签",prop:"meta.auto_close",style:{width:"40%"}},{default:f((()=>[c(N,{modelValue:P.meta.auto_close,"onUpdate:modelValue":o[12]||(o[12]=e=>P.meta.auto_close=e)},{default:f((()=>[c(J,{label:"否",value:!1}),c(J,{label:"是",value:!0})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-a59079bd"]]);export{z as default};
