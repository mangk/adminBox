import{N as A,r as C,a as F,B as D,O as E,P as G,c as n,d as _,k as f,w as l,g as b,f as a,h as p,l as y,t as Q,e as T,F as q,A as H,Q as J}from"./XindexDunG4lwt.js";import{_ as K}from"./X_plugin-vue_export-helperDlAUqK2U.js";const X={style:{display:"flex","flex-flow":"row nowrap","justify-content":"space-between"}},Y={style:{"text-align":"left"}},Z={style:{color:"#f56c6c","font-size":"12px"}},$={style:{color:"#e6a23c","font-size":"12px"}},ee={__name:"premissionSet",props:{modelValue:{type:Number},modelModifiers:{},type:{type:String},typeModifiers:{}},emits:["update:modelValue","update:type"],setup(j){const x=A(j,"modelValue"),M=A(j,"type"),k=C(!1),S=C([]),c=F({}),h=C([]),m=F({});D(x,e=>{e&&(k.value=!0,E().then(o=>{S.value=o.data}),G(x.value,M.value).then(o=>{var i,u,v,s,r;h.value=(i=o.data)==null?void 0:i.ohter_set_list,Object.assign(c,(v=(u=o.data)==null?void 0:u.cur_set)==null?void 0:v.list),Object.assign(m,(r=(s=o.data)==null?void 0:s.result_set)==null?void 0:r.list)}))}),D(c,e=>{for(const o in e)Object.hasOwnProperty.call(e,o)&&(m[o]=I(o))});const I=e=>{var o=0,i=[],u=[];c[e]&&(o=c[e]);for(const w in h.value)if(Object.hasOwnProperty.call(h.value,w)){const d=h.value[w];d.module=="sys_role"&&d.list&&d.list[e]&&i.push(d.list[e]),d.module=="sys_department"&&d.list&&d.list[e]&&u.push(d.list[e])}var v=z(i),s=z(u),r=0;return s!==0&&(r=s),v!==0&&(r=v),o!==0&&(r=o),r},z=e=>{var o=0;for(let i=0;i<e.length;i++){const u=e[i];if(u==-1)return-1;u==1&&o++}return o>0?1:0},L=()=>{J({id:x.value,module:M.value,list:c}).then(()=>{V()})},V=()=>{k.value=!1,x.value=0,h.value=[];for(const e in c)Object.hasOwnProperty.call(c,e)&&delete c[e];for(const e in m)Object.hasOwnProperty.call(m,e)&&delete m[e]};return(e,o)=>{const i=n("Menu"),u=n("Link"),v=n("Pointer"),s=n("el-icon"),r=n("el-table-column"),w=n("Check"),d=n("Close"),O=n("el-radio"),R=n("el-radio-group"),U=n("el-table"),B=n("el-button"),N=n("WarningFilled"),W=n("el-drawer");return _(),f(W,{modelValue:k.value,"onUpdate:modelValue":o[0]||(o[0]=t=>k.value=t),direction:"rtl","before-close":V,"with-header":!1,size:"90%"},{footer:l(()=>[b("div",X,[b("div",null,[a(B,{onClick:L,type:"primary"},{default:l(()=>[p("保存")]),_:1}),a(B,{onClick:V},{default:l(()=>[p("关闭")]),_:1})]),b("div",Y,[b("div",Z,[a(s,null,{default:l(()=>[a(N)]),_:1}),p(" 权限分级说明: 个人设置 > 角色设置 > 部门设置 ")]),b("div",$,[a(s,null,{default:l(()=>[a(N)]),_:1}),p(" 权限同级说明: 拒绝 > 允许; ")])])])]),default:l(()=>[a(U,{"header-cell-class-name":"global-el-table-header",data:S.value,height:"calc(100vh - 62px - 40px )",style:{width:"100%"},"row-key":"id",border:"","default-expand-all":""},{default:l(()=>[a(r,{label:"菜单 · API · 动作",width:"190px",fixed:""},{default:l(t=>[a(s,null,{default:l(()=>[t.row.type=="menu"?(_(),f(i,{key:0})):y("",!0),t.row.type=="api"?(_(),f(u,{key:1})):y("",!0),t.row.type=="action"?(_(),f(v,{key:2})):y("",!0)]),_:2},1024),p(" "+Q(t.row.name),1)]),_:1}),a(r,{label:"结果展示",fixed:"",width:"80px"},{default:l(t=>[m[t.row.id]>0?(_(),f(s,{key:0,style:{color:"#67c23a"}},{default:l(()=>[a(w)]),_:1})):y("",!0),m[t.row.id]<0?(_(),f(s,{key:1,style:{color:"#f56c6c"}},{default:l(()=>[a(d)]),_:1})):y("",!0)]),_:1}),a(r,{label:"当前设置",fixed:"",width:"220px"},{default:l(t=>[a(R,{modelValue:c[t.row.id],"onUpdate:modelValue":P=>c[t.row.id]=P},{default:l(()=>[a(O,{size:"small",value:1},{default:l(()=>[p("允许")]),_:1}),a(O,{size:"small",value:-1},{default:l(()=>[p("拒绝")]),_:1}),a(O,{size:"small",value:0},{default:l(()=>[p("不限")]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),(_(!0),T(q,null,H(h.value,(t,P)=>(_(),f(r,{width:"120px",key:P,label:t.record_name},{default:l(g=>[t.list&&t.list[g.row.id]&&t.list[g.row.id]>0?(_(),f(s,{key:0,style:{color:"#67c23a"}},{default:l(()=>[a(w)]),_:1})):y("",!0),t.list&&t.list[g.row.id]&&t.list[g.row.id]<0?(_(),f(s,{key:1,style:{color:"#f56c6c"}},{default:l(()=>[a(d)]),_:1})):y("",!0)]),_:2},1032,["label"]))),128))]),_:1},8,["data"])]),_:1},8,["modelValue"])}}},oe=K(ee,[["__scopeId","data-v-e37272b8"]]);export{oe as default};
