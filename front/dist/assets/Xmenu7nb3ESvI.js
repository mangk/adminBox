import{a as Q,b as W,c as X,d as Y,m as Z}from"./XmenuDtFVMP-o.js";import{r as V,a as $,M as ee,L as le,f as s,o as f,c as y,d as e,w as o,g as _,e as h,t as k,j as w,A as q,k as z,F as te,z as ae,n as oe,i as ne}from"./Xindex8fzL0qgV.js";import{_ as de}from"./X_plugin-vue_export-helperDlAUqK2U.js";const se={class:"main-content"},ie={key:0,class:"icon-column"},ue={key:0,style:{position:"absolute","z-index":"9999",padding:"4px 10px 0"}},re={style:{"text-align":"left",margin:"0 0 0 10px"}},me={class:"dialog-footer"},pe={__name:"menu",setup(fe){const{proxy:C}=ne(),b=V(!1),F=V([]),I=$([]);for(const[n]of Object.entries(ee))I.push({key:n,label:n});const v=V(),a=$({id:0,pid:"",name:"",path:"",hidden:!1,component:"",sort:0,meta:{title:"",keep_alive:!1,default_menu:!1,icon:"",auto_close:!1,sc_path:"",action_list:null}}),N=$({pid:[{required:!0,trigger:"blur",validator:(n,l,d)=>{if(l===""){d(new Error("父级菜单 不能为空"));return}if(l===a.id){d(new Error("所选菜单不能为当前编辑菜单"));return}d()}}],name:[{required:!0,message:"路由名称 不能为空",trigger:"blur"}],path:[{required:!0,message:"路由地址 不能为空",trigger:"blur"}],hidden:[{required:!0,message:"请选择 是否隐藏",trigger:"blur"}],"meta.title":[{required:!0,message:"菜单名称 不能为空",trigger:"blur"}],"meta.keep_alive":[{required:!0,message:"请选择 是否KeepAlive",trigger:"blur"}],"meta.default_menu":[{required:!0,message:"请选择 是否为基础页面",trigger:"blur"}],"meta.auto_close":[{required:!0,message:"请选择 是否自动关闭标签",trigger:"blur"}]}),A=async n=>{n&&await n.validate((l,d)=>{if(!l)console.log("error submit!",d);else{let r={};console.log(a.id),a.id?r=Q(a):r=W(a),r.then(m=>{m.code===0&&(C.$message.success(m.msg),U(),b.value=!1,x(n))})}})},P=n=>{b.value=!1,x(n)},x=n=>{n&&n.resetFields()},B=(n=!1)=>{n?(a.id=n,X(n).then(l=>{l.code===0&&(a.pid=l.data.pid,a.meta.title=l.data.meta.title,a.name=l.data.name,a.path=l.data.path,a.hidden=l.data.hidden,a.component=l.data.component,a.sort=l.data.sort,a.meta=l.data.meta)})):a.id=0,M(),b.value=!0},L=n=>{n?Y(n).then(l=>{l.code===0&&(C.$message.success(l.msg),U())}):C.$message.error("请选择数据ID"),console.log("del",n)},U=()=>{Z().then(n=>{F.value=n.data[0].children,D.value=n.data})},D=V([]),M=()=>{E(D.value,!1)},E=(n,l)=>{n&&n.forEach(d=>{d.children&&d.children.length?(d.title=d.meta.title,d.disabled=(l||d.id===a.id)&&a.id,E(d.children,d.disabled)):(d.title=d.meta.title,d.disabled=(l||d.id===a.id)&&a.id)})};return le(()=>{U()}),(n,l)=>{const d=s("Plus"),r=s("el-icon"),m=s("el-button"),i=s("el-form-item"),u=s("el-table-column"),O=s("Edit"),S=s("Cherry"),j=s("Delete"),K=s("el-popconfirm"),R=s("el-table"),T=s("el-cascader"),c=s("el-input"),p=s("el-option"),g=s("el-select"),G=s("el-form"),H=s("el-dialog");return f(),y("div",se,[e(i,{label:""},{default:o(()=>[e(m,{type:"primary",onClick:l[0]||(l[0]=t=>B())},{default:o(()=>[e(r,null,{default:o(()=>[e(d)]),_:1}),_(" 新建目录 ")]),_:1})]),_:1}),e(R,{data:F.value,"row-key":"id",height:"var(--global-table)","header-cell-class-name":"global-el-table-header",border:"","highlight-current-row":"","show-overflow-tooltip":"","default-expand-all":""},{default:o(()=>[e(u,{prop:"id",label:"ID",sortable:"",fixed:""}),e(u,{label:"菜单名称","min-width":"120"},{default:o(t=>[h("span",null,k(t.row.meta.title),1)]),_:1}),e(u,{label:"图标","min-width":"140"},{default:o(t=>[t.row.meta.icon?(f(),y("div",ie,[e(r,null,{default:o(()=>[(f(),w(q(t.row.meta.icon)))]),_:2},1024),h("span",null,k(t.row.meta.icon),1)])):z("",!0)]),_:1}),e(u,{prop:"name",label:"路由名称",width:"120"}),e(u,{prop:"path",label:"路由地址",width:"120"}),e(u,{prop:"hidden",label:"隐藏"}),e(u,{prop:"pid",label:"父节点"}),e(u,{prop:"sort",label:"排序",width:"120",sortable:""}),e(u,{prop:"component",label:"模版路经",width:"260"}),e(u,{label:"服务端模版",width:"260"},{default:o(t=>[_(k(t.row.meta?t.row.meta.sc_path:""),1)]),_:1}),e(u,{prop:"action_list",label:"动作列表",width:"260"}),e(u,{fixed:"right",label:"操作",width:"210"},{default:o(t=>[e(m,{link:"",type:"primary",size:"small",onClick:J=>B(t.row.id)},{default:o(()=>[e(r,null,{default:o(()=>[e(O)]),_:1}),_(" 编辑 ")]),_:2},1032,["onClick"]),e(m,{link:"",type:"primary",size:"small"},{default:o(()=>[e(r,null,{default:o(()=>[e(S)]),_:1}),_(" 编辑动作 ")]),_:1}),t.row.children?z("",!0):(f(),w(K,{key:0,title:"删除后不可恢复，确定删除菜单【"+t.row.meta.title+"】?",onConfirm:J=>L(t.row.id),width:"200"},{reference:o(()=>[e(m,{link:"",type:"primary",size:"small"},{default:o(()=>[e(r,null,{default:o(()=>[e(j)]),_:1}),_(" 删除 ")]),_:1})]),_:2},1032,["title","onConfirm"]))]),_:1})]),_:1},8,["data"]),e(H,{modelValue:b.value,"onUpdate:modelValue":l[16]||(l[16]=t=>b.value=t),title:a.id?"编辑菜单":"新建菜单",width:"800",onClose:l[17]||(l[17]=t=>P(v.value))},{footer:o(()=>[h("div",me,[e(m,{onClick:l[13]||(l[13]=t=>x(v.value))},{default:o(()=>[_("重置")]),_:1}),e(m,{onClick:l[14]||(l[14]=t=>P(v.value))},{default:o(()=>[_("取消")]),_:1}),e(m,{type:"primary",onClick:l[15]||(l[15]=t=>A(v.value))},{default:o(()=>[_("保存")]),_:1})])]),default:o(()=>[e(G,{ref_key:"formRef",ref:v,model:a,rules:N,"status-icon":"","label-position":"top","show-all-levels":!1,inline:""},{default:o(()=>[e(i,{label:"父级菜单",prop:"pid",style:{width:"40%"}},{default:o(()=>[e(T,{modelValue:a.pid,"onUpdate:modelValue":l[1]||(l[1]=t=>a.pid=t),options:D.value,props:{expandTrigger:"hover",checkStrictly:!0,value:"id",label:"title",emitPath:!1},style:{width:"100%"}},null,8,["modelValue","options"])]),_:1}),e(i,{label:"菜单名称",prop:"meta.title",style:{width:"40%"}},{default:o(()=>[e(c,{modelValue:a.meta.title,"onUpdate:modelValue":l[2]||(l[2]=t=>a.meta.title=t)},null,8,["modelValue"])]),_:1}),e(i,{label:"路由名称(name)",prop:"name",style:{width:"40%"}},{default:o(()=>[e(c,{modelValue:a.name,"onUpdate:modelValue":l[3]||(l[3]=t=>a.name=t)},null,8,["modelValue"])]),_:1}),e(i,{label:"路由地址(path)",prop:"path",style:{width:"40%"}},{default:o(()=>[e(c,{modelValue:a.path,"onUpdate:modelValue":l[4]||(l[4]=t=>a.path=t)},null,8,["modelValue"])]),_:1}),e(i,{label:"图标",prop:"meta.icon",style:{width:"40%"}},{default:o(()=>[a.meta.icon?(f(),y("span",ue,[e(r,null,{default:o(()=>[(f(),w(q(a.meta.icon)))]),_:1})])):z("",!0),e(g,{modelValue:a.meta.icon,"onUpdate:modelValue":l[5]||(l[5]=t=>a.meta.icon=t),clearable:"",class:"icon-select"},{default:o(()=>[(f(!0),y(te,null,ae(I,t=>(f(),w(p,{key:t.key,label:t.key,value:t.label},{default:o(()=>[h("span",{class:oe(["gva-icon",t.label]),style:{padding:"3px 0 0"}},[e(r,null,{default:o(()=>[(f(),w(q(t.label)))]),_:2},1024)],2),h("span",re,k(t.key),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"排序",prop:"sort",style:{width:"40%"}},{default:o(()=>[e(c,{type:"number",modelValue:a.sort,"onUpdate:modelValue":l[6]||(l[6]=t=>a.sort=t),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),e(i,{label:"模版地址",prop:"meta.component",style:{width:"40%"}},{default:o(()=>[e(c,{modelValue:a.component,"onUpdate:modelValue":l[7]||(l[7]=t=>a.component=t),placeholder:"views/util/serverComponent.vue"},null,8,["modelValue"])]),_:1}),e(i,{label:"服务端模版地址",prop:"meta.sc_path",style:{width:"40%"}},{default:o(()=>[e(c,{modelValue:a.meta.sc_path,"onUpdate:modelValue":l[8]||(l[8]=t=>a.meta.sc_path=t)},null,8,["modelValue"])]),_:1}),e(i,{label:"是否隐藏",prop:"hidden",style:{width:"40%"}},{default:o(()=>[e(g,{modelValue:a.hidden,"onUpdate:modelValue":l[9]||(l[9]=t=>a.hidden=t)},{default:o(()=>[e(p,{label:"否",value:!1}),e(p,{label:"是",value:!0})]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"KeepAlive",prop:"meta.keep_alive",style:{width:"40%"}},{default:o(()=>[e(g,{modelValue:a.meta.keep_alive,"onUpdate:modelValue":l[10]||(l[10]=t=>a.meta.keep_alive=t)},{default:o(()=>[e(p,{label:"否",value:!1}),e(p,{label:"是",value:!0})]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"基础页面",prop:"meta.default_menu",style:{width:"40%"}},{default:o(()=>[e(g,{modelValue:a.meta.default_menu,"onUpdate:modelValue":l[11]||(l[11]=t=>a.meta.default_menu=t)},{default:o(()=>[e(p,{label:"否",value:!1}),e(p,{label:"是",value:!0})]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"自动关闭标签",prop:"meta.auto_close",style:{width:"40%"}},{default:o(()=>[e(g,{modelValue:a.meta.auto_close,"onUpdate:modelValue":l[12]||(l[12]=t=>a.meta.auto_close=t)},{default:o(()=>[e(p,{label:"否",value:!1}),e(p,{label:"是",value:!0})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}},ve=de(pe,[["__scopeId","data-v-9a560cd5"]]);export{ve as default};
